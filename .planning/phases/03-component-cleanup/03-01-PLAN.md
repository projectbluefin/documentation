---
phase: 03-component-cleanup
plan: 01
type: execute
wave: 1
depends_on: [02-01]
files_modified:
  - src/theme/BlogPostItem/index.tsx
  - src/theme/BlogPostItem/Footer/index.tsx
  - src/theme/DocItem/Footer/index.tsx
  - src/components/BoardChangelog.tsx
  - src/components/CommunityFeeds.tsx
  - src/components/FeedItems.tsx
  - src/components/GiscusComments/index.tsx
  - src/components/GitHubProfileCard.tsx
  - src/components/GnomeExtensions.tsx
  - src/components/MusicPlaylist.tsx
  - src/components/PackageSummary.tsx
  - src/components/PageContributors.tsx
  - src/components/ProjectCard.tsx
  - src/pages/board.tsx
  - src/pages/changelogs.tsx
  - src/config/packageConfig.ts
  - src/types/data.d.ts
  - src/types/theme.d.ts
autonomous: true

must_haves:
  truths:
    - "All components compile without TypeScript errors"
    - "SSR safety guards are present where needed (window/localStorage checks)"
    - "Swizzled components have documented rationale or are removed"
    - "No commented-out code or TODOs remain in components"
    - "All components use proper types from src/types/data.d.ts"
  artifacts:
    - path: "src/theme/DocItem/Footer/index.tsx"
      provides: "PageContributors integration with rationale comment"
      contains: "// Swizzled to add PageContributors"
    - path: "src/theme/BlogPostItem/index.tsx"
      provides: "Clean wrapper with rationale or removed"
      min_lines: 10
    - path: "src/theme/BlogPostItem/Footer/index.tsx"
      provides: "Clean wrapper with rationale or removed"
      min_lines: 8
    - path: "src/components/GitHubProfileCard.tsx"
      provides: "SSR-safe component with typeof window guards"
      pattern: 'typeof window !== "undefined"'
    - path: "src/components/ProjectCard.tsx"
      provides: "SSR-safe component with typeof window guards"
      pattern: 'typeof window !== "undefined"'
  key_links:
    - from: "src/components/*"
      to: "src/types/data.d.ts"
      via: "TypeScript imports"
      pattern: "import.*from.*types/data"
    - from: "src/theme/DocItem/Footer/index.tsx"
      to: "src/components/PageContributors.tsx"
      via: "Component import and render"
      pattern: "import.*PageContributors"
    - from: "src/components/GitHubProfileCard.tsx"
      to: "typeof window checks"
      via: "SSR safety guard"
      pattern: 'typeof window !== "undefined"'
---

<objective>
Audit and clean all TypeScript components, document swizzled components, and verify SSR safety.

Purpose: Ensure all components are production-ready with no dead code, proper documentation, and SSR safety verified. Phase 2 fixed type errors; Phase 3 ensures component quality and maintainability.

Output: Clean, documented component codebase with verified SSR safety and swizzled component rationale documented.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-type-system-repair/02-01-SUMMARY.md
@.planning/codebase/CONCERNS.md
@.planning/codebase/CONVENTIONS.md
@AGENTS.md

# Key context from Phase 2

Phase 2 eliminated all TypeScript errors:

- Fixed FeedData → ParsedFeed interface
- Created src/types/data.d.ts with 7 interfaces
- Fixed React 19 JSX namespace in BlogPostItem

# Current state

- TypeScript compilation: 0 errors ✅
- SSR safety: Already correctly implemented with typeof window guards ✅
- Components: Using correct types from Phase 2 ✅

# What Phase 3 must accomplish

- COMP-01 ✅: Already complete (Phase 2 fixed FeedItems.tsx errors)
- COMP-02 ✅: Already complete (Phase 2 fixed PackageSummary.tsx errors)
- COMP-03 ✅: Already complete (Phase 2 fixed BlogPostItem/index.tsx error)
- COMP-04: Audit all components for SSR safety (verify existing guards)
- COMP-05: Audit 3 swizzled components, document rationale or remove
- COMP-06: Remove dead code, commented code, unused exports
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Audit and document swizzled theme components</name>
  <files>
    src/theme/DocItem/Footer/index.tsx
    src/theme/BlogPostItem/index.tsx
    src/theme/BlogPostItem/Footer/index.tsx
  </files>
  <action>
Audit the 3 swizzled Docusaurus theme components and either add documentation explaining their necessity or remove them if they serve no purpose.

**Analysis for each component:**

1. **src/theme/DocItem/Footer/index.tsx** (37 lines)
   - Current function: Wraps DocItem footer to add PageContributors component showing file contributors
   - Rationale: Adds value by showing GitHub contributors for each documentation page
   - Action: Add header comment explaining swizzling rationale:
     ```typescript
     /**
      * Swizzled to add PageContributors component to documentation page footers.
      * Displays GitHub contributors for each doc page based on file path.
      * Original wrapper pattern from Docusaurus theme customization.
      */
     ```
   - Keep this component (provides useful feature)

2. **src/theme/BlogPostItem/index.tsx** (14 lines)
   - Current function: Wraps BlogPostItem with commented-out Giscus comments
   - Rationale: Comment says "Giscus comments disabled" but component does nothing
   - Action: REMOVE this component - it's a no-op wrapper that can be deleted
     - Delete the file
     - Note: Docusaurus will fall back to original BlogPostItem automatically

3. **src/theme/BlogPostItem/Footer/index.tsx** (11 lines)
   - Current function: Passthrough wrapper with no customization
   - Rationale: No value added, pure passthrough to original Footer
   - Action: REMOVE this component - unnecessary wrapper
     - Delete the file
     - Note: Docusaurus will fall back to original Footer automatically

**Verification:**
After removing the 2 unnecessary wrappers, verify build and dev server still work:

- `npm run typecheck` - should pass (no TypeScript errors from removal)
- `npm run build` - should succeed
- Manual check: Blog posts should render normally without wrappers

**Important:** Do NOT remove DocItem/Footer - it provides PageContributors integration which is a real feature.
</action>
<verify>
npm run typecheck # Should pass
npm run build # Should succeed
ls src/theme/BlogPostItem/ # Should show only index.tsx is deleted (no Footer directory)
</verify>
<done>

- DocItem/Footer/index.tsx has header comment explaining swizzling rationale
- BlogPostItem/index.tsx removed (no-op wrapper)
- BlogPostItem/Footer/index.tsx removed (no-op wrapper)
- Build and typecheck pass after cleanup
- Blog posts render correctly without unnecessary wrappers
  </done>
  </task>

<task type="auto">
  <name>Task 2: Verify SSR safety in all components</name>
  <files>
    src/components/GitHubProfileCard.tsx
    src/components/ProjectCard.tsx
    src/components/PageContributors.tsx
    src/components/MusicPlaylist.tsx
    src/components/GnomeExtensions.tsx
    src/components/BoardChangelog.tsx
    src/components/FeedItems.tsx
    src/components/PackageSummary.tsx
    src/components/CommunityFeeds.tsx
    src/components/GiscusComments/index.tsx
  </files>
  <action>
Audit all React components for Server-Side Rendering (SSR) safety. Verify that any usage of browser-only APIs (window, localStorage, document) is properly guarded.

**SSR Safety Checklist:**

1. **Components with localStorage/window** (already correctly implemented):
   - GitHubProfileCard.tsx: ✓ Has `typeof window !== "undefined"` guards (lines 84, 149, 180)
   - ProjectCard.tsx: ✓ Has `typeof window !== "undefined"` guards (lines 96, 126)
   - PageContributors.tsx: ✓ Has `typeof window !== "undefined"` guards (lines 143, 172)

2. **Components using useEffect for client-side operations**:
   - MusicPlaylist.tsx: ✓ Uses useEffect for data loading (client-side only)
   - GnomeExtensions.tsx: ✓ Uses useEffect for data loading (client-side only)
   - BoardChangelog.tsx: ✓ Uses useEffect for data loading (client-side only)
   - GiscusComments/index.tsx: ✓ Third-party component, already SSR-safe

3. **Components with static data only** (no SSR concerns):
   - FeedItems.tsx: ✓ Uses Docusaurus hook (already SSR-safe)
   - PackageSummary.tsx: ✓ Uses Docusaurus hook (already SSR-safe)
   - CommunityFeeds.tsx: ✓ Static rendering, no browser APIs

**Verification approach:**

- Use grep to confirm typeof window guards are present
- Use grep to confirm no direct window/localStorage access outside guards
- Review each component's data fetching strategy

**Add comments to components that are already SSR-safe but may not be obvious:**

- Add JSDoc comments to components with window/localStorage explaining the SSR safety pattern
- Example for GitHubProfileCard.tsx:
  ```typescript
  /**
   * SSR-Safe: Uses typeof window checks before accessing localStorage.
   * Data fetching strategy: build-time JSON → localStorage cache → runtime API
   */
  ```

**Expected outcome:** All components verified SSR-safe, with comments added where helpful. No changes needed to existing guards (already correct).
</action>
<verify>

# Verify window guards exist in components that need them

grep -n "typeof window" src/components/GitHubProfileCard.tsx src/components/ProjectCard.tsx src/components/PageContributors.tsx

# Verify no unguarded window/localStorage usage

! grep -n "window\." src/components/\*.tsx | grep -v "typeof window" | grep -v "\/\/"

# Build verification (SSR happens during build)

npm run build
</verify>
<done>

- All components with window/localStorage access have typeof window guards
- No unguarded browser API usage exists
- JSDoc comments added to components explaining SSR safety pattern
- Build succeeds (proves SSR safety during static site generation)
  </done>
  </task>

<task type="auto">
  <name>Task 3: Remove dead code and clean up all TypeScript files</name>
  <files>
    src/components/BoardChangelog.tsx
    src/components/CommunityFeeds.tsx
    src/components/FeedItems.tsx
    src/components/GiscusComments/index.tsx
    src/components/GitHubProfileCard.tsx
    src/components/GnomeExtensions.tsx
    src/components/MusicPlaylist.tsx
    src/components/PackageSummary.tsx
    src/components/PageContributors.tsx
    src/components/ProjectCard.tsx
    src/pages/board.tsx
    src/pages/changelogs.tsx
    src/config/packageConfig.ts
    src/types/data.d.ts
    src/types/theme.d.ts
  </files>
  <action>
Audit all 17 TypeScript files for dead code, commented code, unused exports, and TODOs. Remove anything that doesn't serve a purpose.

**Dead code patterns to search for:**

1. Commented-out code blocks (multi-line comments with code)
2. TODO, FIXME, HACK comments
3. Unused imports (TypeScript will warn about these)
4. Unused exported functions or interfaces
5. Console.log statements left from debugging (except intentional logging)
6. Abandoned experiments or placeholder code

**Search commands to run:**

```bash
# Find commented code (looking for // followed by code patterns)
grep -r "^[[:space:]]*//.*=\|^[[:space:]]*//.*function\|^[[:space:]]*//.*const\|^[[:space:]]*//.*import" src --include="*.tsx" --include="*.ts"

# Find TODO/FIXME/HACK markers
grep -r "// TODO\|// FIXME\|// HACK\|@ts-ignore\|@ts-expect-error" src --include="*.tsx" --include="*.ts"

# Find console.log debugging statements (excluding intentional logging)
grep -r "console\.log\|console\.debug" src --include="*.tsx" --include="*.ts"
```

**File-by-file review focus:**

1. **Components (10 files):** Look for:
   - Unused state variables
   - Commented-out JSX
   - Unused props in interfaces
   - Debug console.logs

2. **Pages (2 files):** Look for:
   - Commented-out sections
   - Unused imports
   - Placeholder content

3. **Config (1 file - packageConfig.ts):** Look for:
   - Unused package patterns
   - Commented-out patterns
   - Outdated comments

4. **Types (2 files):** Look for:
   - Unused interface definitions
   - Commented-out types
   - Duplicate interface definitions

5. **Theme components (remaining after Task 1):** Look for:
   - Commented-out functionality
   - Unused imports

**What NOT to remove:**

- Intentional error handling with empty catch blocks
- Intentional console.error/console.warn for user-facing errors
- Comments explaining complex logic (keep these)
- JSDoc documentation comments (keep these)

**Approach:**

1. Run search commands to find candidates
2. Review each finding in context
3. Remove only genuine dead code
4. Preserve useful explanatory comments
5. Run typecheck after each batch of changes
   </action>
   <verify>

# Verify no TODO/FIXME remain (except in comments explaining external issues)

! grep -r "// TODO\|// FIXME\|// HACK" src --include="_.tsx" --include="_.ts" | grep -v "external"

# Verify TypeScript still compiles

npm run typecheck

# Verify build still works

npm run build

# Count files before and after to ensure we only cleaned, didn't delete

find src -name "_.tsx" -o -name "_.ts" | wc -l
</verify>
<done>

- All commented-out code removed from components
- No TODO, FIXME, or HACK comments remain (unless documenting external issues)
- Unused imports and exports removed
- Debug console.log statements removed (intentional logging preserved)
- TypeScript compilation passes (0 errors)
- Build succeeds with cleaned codebase
- File count matches expected (only BlogPostItem wrappers removed from Task 1)
  </done>
  </task>

</tasks>

<verification>
**Overall Phase 3 Success Criteria:**

```bash
# 1. TypeScript compilation clean
npm run typecheck
# Expected: No errors

# 2. Build succeeds
npm run build
# Expected: Success, site builds completely

# 3. Swizzled components audit
ls -R src/theme/
# Expected: Only DocItem/Footer remains with documented rationale

# 4. SSR safety verified
grep -c "typeof window" src/components/GitHubProfileCard.tsx src/components/ProjectCard.tsx src/components/PageContributors.tsx
# Expected: 3+ occurrences per file (guards present)

# 5. No dead code markers
! grep -r "// TODO\|// FIXME" src --include="*.tsx" --include="*.ts" | grep -v external
# Expected: No output (no TODOs remain)

# 6. Dev server starts successfully
npm start 2>&1 | tee /tmp/docusaurus-server.log &
sleep 40
curl -I http://localhost:3000/
# Expected: HTTP/1.1 200 OK
```

**Manual verification:**

- Navigate to /changelogs/ - should render correctly
- Navigate to /donations/contributors - components should load
- Navigate to blog posts - should render without removed wrappers
- Check page footers on docs - PageContributors should display
  </verification>

<success_criteria>
**Phase 3 complete when:**

1. ✅ TypeScript compilation shows 0 errors (npm run typecheck)
2. ✅ Build completes successfully (npm run build)
3. ✅ Only 1 swizzled component remains: DocItem/Footer/index.tsx with documented rationale
4. ✅ BlogPostItem wrappers removed (2 unnecessary files deleted)
5. ✅ All components with window/localStorage have typeof window guards
6. ✅ JSDoc comments added explaining SSR safety patterns
7. ✅ No commented-out code remains in any TypeScript files
8. ✅ No TODO/FIXME/HACK comments remain (except external issue documentation)
9. ✅ Development server starts and all pages render correctly
10. ✅ All 6 COMP requirements verified: - COMP-01 ✅: FeedItems.tsx errors resolved (Phase 2) - COMP-02 ✅: PackageSummary.tsx errors resolved (Phase 2) - COMP-03 ✅: BlogPostItem/index.tsx error resolved (Phase 2) - COMP-04 ✅: SSR safety verified (this phase) - COMP-05 ✅: Swizzled components audited (this phase) - COMP-06 ✅: Dead code removed (this phase)
    </success_criteria>

<output>
After completion, create `.planning/phases/03-component-cleanup/03-01-SUMMARY.md` documenting:

- Components audited for SSR safety
- Swizzled components analyzed (1 kept, 2 removed)
- Dead code removal results
- Files modified/deleted
- Verification results
- Any issues found and resolved
  </output>
