---
phase: 04-validation-quality-gates
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .eslintrc.json
  - .prettierrc.json
  - package.json
autonomous: true

must_haves:
  truths:
    - "Developer can run npm run typecheck and see zero compilation errors"
    - "Developer can run npm run prettier-lint and see no new formatting violations"
    - "Developer can run npm run build and build completes successfully"
    - "Developer can run npm run lint and ESLint validates code quality"
    - "CI/CD pipeline enforces validation gates automatically"
  artifacts:
    - path: ".eslintrc.json"
      provides: "ESLint configuration with Docusaurus plugin"
      min_lines: 10
    - path: ".prettierrc.json"
      provides: "Prettier configuration aligned with Docusaurus conventions"
      min_lines: 5
    - path: "package.json"
      provides: "npm scripts for lint and updated devDependencies"
      exports: ["scripts.lint"]
  key_links:
    - from: "package.json"
      to: "@docusaurus/eslint-plugin"
      via: "devDependencies entry"
      pattern: "@docusaurus/eslint-plugin"
    - from: ".eslintrc.json"
      to: "plugin:@docusaurus/recommended"
      via: "extends configuration"
      pattern: "plugin:@docusaurus/recommended"
    - from: "package.json"
      to: "prettier configuration"
      via: "devDependencies has prettier (already exists)"
      pattern: "prettier.*3\\.6\\.2"
---

<objective>
Establish automated validation gates to enforce code quality standards going forward - ESLint integration, Prettier configuration formalization, and validation baseline documentation.

Purpose: Complete Phase 4 requirements (QUALITY-01, QUALITY-02, QUALITY-03) by adding ESLint with Docusaurus plugin, formalizing Prettier config, and ensuring all validation commands pass cleanly.

Output: Fully validated codebase with automated quality gates - zero TypeScript errors, ESLint configured, Prettier config formalized, and all builds passing consistently.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/03-component-cleanup/03-01-SUMMARY.md
@AGENTS.md
</context>

<tasks>

<task type="auto">
  <name>Configure ESLint with Docusaurus plugin</name>
  <files>
    .eslintrc.json
    package.json
  </files>
  <action>
Add ESLint configuration aligned with Docusaurus best practices:

1. **Install ESLint dependencies** (add to package.json devDependencies):
   - `@docusaurus/eslint-plugin`: Official Docusaurus ESLint plugin
   - `eslint`: Latest stable version (^9.x)
   - Note: TypeScript ESLint integration already handled by Docusaurus plugin

2. **Create .eslintrc.json** with Docusaurus recommended configuration:

   ```json
   {
     "extends": ["plugin:@docusaurus/recommended"],
     "plugins": ["@docusaurus"],
     "env": {
       "browser": true,
       "node": true,
       "es2022": true
     },
     "parserOptions": {
       "ecmaVersion": "latest",
       "sourceType": "module",
       "ecmaFeatures": {
         "jsx": true
       }
     },
     "rules": {
       "@docusaurus/string-literal-i18n-messages": "warn",
       "@docusaurus/no-untranslated-text": "off"
     },
     "ignorePatterns": [
       "build/",
       "node_modules/",
       ".docusaurus/",
       "static/data/*.json",
       "static/feeds/*.json"
     ]
   }
   ```

3. **Add lint script to package.json**:
   - Add `"lint": "eslint . --ext .js,.jsx,.ts,.tsx"` to scripts section
   - Place after `prettier-lint` script for consistency

4. **Run npm install** to install new ESLint dependencies:
   - Use standard `npm install` (no --legacy-peer-deps needed - React overrides already configured)

**Why these choices:**

- `plugin:@docusaurus/recommended`: Official Docusaurus ruleset - ensures compatibility
- `ecmaVersion: "latest"`: Matches project's modern JavaScript usage
- Ignore patterns: Exclude generated files (build output, auto-generated JSON data)
- Rules: Enable i18n warnings but disable untranslated-text (docs are English-only)
  </action>
  <verify>

1. Run `npm run lint` and verify ESLint runs without crashing
2. Check that ESLint validates TypeScript files: `npm run lint -- src/components/FeedItems.tsx`
3. Verify auto-generated files are ignored: `npm run lint` should not scan static/data/ or static/feeds/
4. Confirm output shows no errors or warnings (or only expected warnings from existing code)
   </verify>
   <done>

- `.eslintrc.json` exists with Docusaurus plugin configuration
- `package.json` includes `@docusaurus/eslint-plugin` and `eslint` in devDependencies
- `npm run lint` command executes successfully
- ESLint validates TypeScript and JavaScript files without blocking errors
  </done>
  </task>

<task type="auto">
  <name>Formalize Prettier configuration</name>
  <files>
    .prettierrc.json
  </files>
  <action>
Create explicit Prettier configuration to formalize existing formatting standards:

1. **Create .prettierrc.json** with project conventions:
   ```json
   {
     "printWidth": 80,
     "tabWidth": 2,
     "useTabs": false,
     "semi": true,
     "singleQuote": false,
     "quoteProps": "as-needed",
     "jsxSingleQuote": false,
     "trailingComma": "es5",
     "bracketSpacing": true,
     "arrowParens": "always",
     "proseWrap": "preserve",
     "endOfLine": "lf",
     "overrides": [
       {
         "files": "*.md",
         "options": {
           "proseWrap": "preserve"
         }
       }
     ]
   }
   ```

**Rationale for these settings:**

- `printWidth: 80`: Docusaurus default, matches existing code
- `singleQuote: false`: Existing codebase uses double quotes consistently
- `trailingComma: "es5"`: Conservative choice, ES5-compatible
- `proseWrap: "preserve"`: Don't auto-wrap markdown prose (preserves author intent)
- `endOfLine: "lf"`: Unix-style line endings (project standard)

**Why formalize config:**

- Currently using Prettier defaults implicitly (no .prettierrc exists)
- Explicit config prevents surprises if Prettier changes defaults
- Documents team formatting conventions
- Makes prettier-lint warnings more predictable

Note: .prettierignore already exists and should be preserved.
</action>
<verify>

1. Run `npm run prettier-lint` and verify same files show warnings as before
2. Check that config is loaded: `npx prettier --find-config-path src/components/FeedItems.tsx` should show `.prettierrc.json`
3. Confirm no new formatting violations introduced by config change
   </verify>
   <done>

- `.prettierrc.json` exists with explicit formatting rules
- `npm run prettier-lint` output matches pre-config baseline (same warnings)
- Prettier configuration is discoverable and loads correctly
  </done>
  </task>

<task type="auto">
  <name>Validate all quality gates and document baseline</name>
  <files>
    None (validation only)
  </files>
  <action>
Run comprehensive validation to confirm all quality gates pass:

1. **TypeScript validation:**

   ```bash
   npm run typecheck
   ```

   Expected: Exit code 0, no compilation errors (down from original 14 errors)

2. **Prettier validation:**

   ```bash
   npm run prettier-lint
   ```

   Expected: Warnings on existing files are acceptable (documented in AGENTS.md)
   - Expected warnings: ~25 files with formatting issues (existing, not introduced by this project)
   - These warnings are tolerated and documented as pre-existing
   - No NEW warnings should appear beyond the baseline

3. **ESLint validation:**

   ```bash
   npm run lint
   ```

   Expected: Exit code 0 or only warnings (no blocking errors)
   - Warnings on existing code are acceptable if not fixable without content changes
   - No errors that block builds

4. **Build validation:**

   ```bash
   npm run build
   ```

   Expected: Build completes successfully with "SUCCESS" message
   - Data fetching completes (feeds, playlists, profiles, repos, contributors, board data)
   - Static site generation succeeds
   - All pages render without errors

5. **Production validation:**
   ```bash
   npm run serve &
   sleep 5
   curl -I http://localhost:3000/ | grep "200 OK"
   pkill -f "docusaurus serve"
   ```
   Expected: HTTP 200 response, site serves correctly

**Success criteria:**

- All validation commands complete without blocking errors
- TypeScript: 0 errors (verified: already passing from Phase 2-3)
- Prettier: Expected warnings only (25 files, no new violations)
- ESLint: 0 blocking errors (warnings acceptable)
- Build: SUCCESS message, all data fetched
- Serve: Site loads at http://localhost:3000/

**If any validation fails:**

- Document the failure in task output
- Identify if it's a new issue or pre-existing
- Fix if blocking, document if acceptable baseline
  </action>
  <verify>
  Run all validation commands in sequence and verify exit codes:

```bash
npm run typecheck && echo "✓ TypeScript" || echo "✗ TypeScript FAILED"
npm run prettier-lint && echo "✓ Prettier" || echo "⚠ Prettier (warnings expected)"
npm run lint && echo "✓ ESLint" || echo "✗ ESLint FAILED"
npm run build && echo "✓ Build" || echo "✗ Build FAILED"
```

All commands should complete. TypeScript and Build must exit 0. Prettier and ESLint may have warnings.
</verify>
<done>

- `npm run typecheck` exits 0 with no TypeScript errors
- `npm run prettier-lint` completes with only expected warnings on existing files
- `npm run lint` completes with no blocking ESLint errors
- `npm run build` exits 0 with SUCCESS message
- `npm run serve` successfully serves production build
- All Phase 4 requirements verified complete (QUALITY-01, QUALITY-02, QUALITY-03)
  </done>
  </task>

</tasks>

<verification>
**Overall phase validation:**

1. **QUALITY-01 (Dead code removed):** Already verified in Phase 3 - codebase clean with no TODOs, debug logs, or commented code
2. **QUALITY-02 (All validation commands pass):** Verified in Task 3 - typecheck (0 errors), prettier-lint (expected warnings), lint (no blocking errors), build (SUCCESS)
3. **QUALITY-03 (ESLint configuration added):** Verified in Task 1 - .eslintrc.json exists with @docusaurus/eslint-plugin

**Regression checks:**

- Verify no TypeScript errors introduced: `npm run typecheck` still exits 0
- Verify build still works: `npm run build` still completes successfully
- Verify no new Prettier violations: Same warning count as before configuration

**Integration verification:**

- ESLint integrates with TypeScript checking
- Prettier configuration doesn't conflict with ESLint
- All validation commands can run in CI/CD pipeline
  </verification>

<success_criteria>

1. Developer can run `npm run typecheck` and see zero TypeScript compilation errors
2. Developer can run `npm run prettier-lint` and see only expected warnings on existing files (no new violations)
3. Developer can run `npm run build` and build completes with SUCCESS message and all data fetched
4. Developer can run `npm run lint` and ESLint validates code without blocking errors
5. Developer can run `npm run serve` and production site loads correctly at http://localhost:3000/
6. ESLint configuration exists using @docusaurus/eslint-plugin official recommended preset
7. Prettier configuration exists and formalizes project formatting standards
8. All Phase 4 requirements complete: QUALITY-01 ✓, QUALITY-02 ✓, QUALITY-03 ✓
   </success_criteria>

<output>
After completion, create `.planning/phases/04-validation-quality-gates/04-01-SUMMARY.md` with:
- Validation baseline documented (all commands passing)
- ESLint configuration details and rationale
- Prettier configuration rationale
- Any warnings/errors that are expected and acceptable
- Verification that all 16 v1 requirements are now complete (CONFIG 3/3, TYPE 4/4, COMP 6/6, QUALITY 3/3)
</output>
